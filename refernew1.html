<!doctype html>
<html lang="en"> 
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Refer and Earn</title> 
  <link rel="stylesheet" href="./assets/css/style.css"> <!-- Link to your global CSS --> 
 <style type="text/css" id="dcoder_stylesheet">/*-----------------------------------*\
  #REFER AND EARN PAGE
\*-----------------------------------*/
body {
  background: rgb(131,58,180);
background: linear-gradient(90deg, rgba(131,58,180,1) 0%, rgba(33,3,3,1) 50%, rgba(252,176,69,1) 100%); /* Use raisin black as the background */
}
.form-container {
  background: var(--raisin-black-1);
  padding: 40px;
  border-radius: 8px;
  box-shadow: 0 4px 8px hsla(0, 0%, 0%, 0.3);
  max-width: 400px;
  width: 100%;
  text-align: center;
  align: center;
}

.form-container h2 {
  color: var(--orange);
  font-family: var(--ff-oswald);
  font-size: var(--fs-2);
  margin-bottom: 20px;
}

.form-container input {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
  border: 1px solid var(--light-gray);
  border-radius: 4px;
  background: var(--raisin-black-2);
  color: var(--white);
}

.form-container input::placeholder {
  color: var(--light-gray);
}

.form-container button {
  width: 100%;
  padding: 10px;
  background-color: var(--orange);
  color: var(--white);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-family: var(--ff-oswald);
  font-size: var(--fs-6);
  text-transform: uppercase;
  transition: var(--transition-1);
}

.form-container button:hover {
  background-color: var(--raisin-black-3);
}

.referral-link {
  margin-top: 20px;
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--white);
}

.referral-link span {
  color: var(--orange);
}

.bottom-gif {
  position: absolute;
  bottom: 0px;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
}

.bottom-gif img {
  max-width: 100%;
  height: auto;
  border-radius: 8px;
}</style></head> 
 <body> 
  <div class="container"> 
   <div class="form-container"> 
    <h2 class="section-title">Refer and Earn</h2> 
    <form id="referForm"> 
     <input type="text" id="name" placeholder="Your Name" required> 
     <input type="email" id="email" placeholder="Your Email" required> 
     <input type="text" id="whatsapp" placeholder="Your WhatsApp Number" required> <button type="submit" class="btn btn-primary">Get Referral Link</button> 
    </form> 
    <div id="referralLink" class="referral-link"></div> 
   </div> 
  </div> <!-- Add the GIF at the bottom --> 
  <div class="bottom-gif"> 
   <img src="money_hand.gif" alt="Animated GIF"> 
  </div> 
  <script>
    document.getElementById('referForm').addEventListener('submit', async function(event) {
      event.preventDefault();

      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      const whatsapp = document.getElementById('whatsapp').value;

      // Generate a referral ID (you can use the email or name to create a unique ID)
      const referralId = generateReferralId(name, email);

      try {
          // Send data to the serverless function (replace with your actual API endpoint)
          const response = await fetch('/api/saveUserData', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({ name, email, whatsapp, referralId }),
          });

          const data = await response.json();

          if (data.success) {
              // Display the referral link to the user
              const referralLink = data.referralLink; // Replace with the actual referral link from the response
              const referralLinkContainer = document.getElementById('referralLink');
              referralLinkContainer.innerHTML = `
                <span>${referralLink}</span>
                <button class="btn btn-secondary" onclick="copyToClipboard('${referralLink}')">Copy</button>
              `;
          } else {
              alert('Failed to generate referral link. Please try again.');
          }
      } catch (error) {
          console.error('Error:', error);
          alert('An error occurred. Please try again.');
      }
    });

    function generateReferralId(name, email) {
      // Simple example: Combine name and email to create a referral ID
      return `${name.replace(/\s+/g, '_').toLowerCase()}_${email.split('@')[0]}`;
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        alert('Referral link copied to clipboard!');
      }).catch(() => {
        alert('Failed to copy referral link.');
      });
    }
  </script> 
 
</body></html>
